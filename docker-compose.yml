version: '3'
services:

  # keygen:
  #   image: kitsuyui/docker-ssh
  #   volumes:
  #     - ./home_ssh:/home/sshuser/.ssh
  #   command: ["ssh-keygen"]

  example_left_forward_8080:
    # network_mode: host
    image: kitsuyui/docker-ssh:latest@sha256:02da77544dc7b17c8799ea8500e10cae1a29efbeaad0242f23cb176140ddd6e2
    volumes:
      - ./home_ssh:/home/sshuser/.ssh
    command: ssh -N -L 8080:127.0.0.1:8080 examplehost

  example_right_forward_8080:
    # network_mode: host
    image: kitsuyui/docker-ssh:latest@sha256:02da77544dc7b17c8799ea8500e10cae1a29efbeaad0242f23cb176140ddd6e2
    volumes:
      - ./home_ssh:/home/sshuser/.ssh
    # GatewayPorts=clientspecified is needed in examplehost
    command: ssh -N -R 8080:127.0.0.1:8080 examplehost
